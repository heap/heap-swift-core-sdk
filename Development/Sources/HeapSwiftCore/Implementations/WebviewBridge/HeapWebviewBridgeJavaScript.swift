// Source: https://github.com/heap/heap-webview-core/commit/facd079ae64506ad4c3a03e5e5bc1c5611e4f1bf
let heapWebviewBridgeJavascript = """
(()=>{"use strict";var e,t,n,r,i,o,a={175:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createNoopBridge=void 0;var n="\\nFailed to find a suitable bridge for Heap. All operations will be ignored.\\n\\nIf using HeapSwiftCore (Apple platforms), ensure you are calling Heap.attachWebView with the appropriate origins.\\n".trim();t.createNoopBridge=function(){var e=!1;return function(){return e||(e=!0,console.warn(n)),Promise.resolve(null)}}},367:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.createNoopBridge=void 0;var o=n(175);Object.defineProperty(t,"createNoopBridge",{enumerable:!0,get:function(){return o.createNoopBridge}}),i(n(576),t)},576:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isHeapSDKInvocation=t.isHeapSDKInvocationResult=void 0,t.isHeapSDKInvocationResult=function(e){return"result"===e.type},t.isHeapSDKInvocation=function(e){return"invocation"===e.type}},843:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function u(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(u){return function(c){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(a=0)),a;)try{if(n=1,r&&(i=2&u[0]?r.return:u[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,u[1])).done)return i;switch(r=0,i&&(u=[2&u[0],i.value]),u[0]){case 0:case 1:i=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!i||u[1]>i[0]&&u[1]<i[3])){a.label=u[1];break}if(6===u[0]&&a.label<i[1]){a.label=i[1],i=u;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(u);break}i[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(e){u=[6,e],r=0}finally{n=i=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.createAutocaptureMethods=void 0;var o=n(502),a=n(270);t.createAutocaptureMethods=function(e,t,n){void 0===n&&(n=null);var u=null==n?void 0:n.name,c=(0,o.sanitizeSourceInfo)(n,t,u);return{trackInteraction:function(n,s,l,f,d,p){return r(this,void 0,void 0,(function(){var r,v,g,y,b,h;return i(this,(function(i){switch(i.label){case 0:return r=(0,o.sanitizeInteractionType)(n,t,u),v=(0,o.sanitizeInteractionNodes)(s,t,u),g=(0,o.sanitizeSourceInfo)(d,t,u)||c,y=(0,o.sanitizeTimestamp)(f,t,u),[4,(0,a.resolvePageviewKey)(p,t,u)];case 1:return b=i.sent(),r&&v?(h={interaction:r,nodes:v},(0,o.isNonEmptyString)(l)&&(h.callbackName=l),y&&(h.javascriptEpochTimestamp=y),g&&(h.sourceLibrary=g),b&&(h.pageviewKey=b),e("trackInteraction",h),[2]):(t.warn("trackInteraction failed because interaction or nodes were invalid.",u),[2])}}))}))},trackPageview:function(n,s,l,f){var d=(0,o.sanitizePageviewProperties)(n,t,u);if(!d)return t.warn("trackPageview failed because properties could not be converted to an object.",u),Promise.resolve(null);var p=(0,o.sanitizeSourceInfo)(l,t,u)||c,v=(0,o.sanitizeTimestamp)(s,t,u),g={properties:d};v&&(g.javascriptEpochTimestamp=v),p&&(g.sourceLibrary=p),g.deadKeys=(0,a.getDeadKeys)();var y=function(t,n,o){return r(this,void 0,void 0,(function(){var r,u,c,s;return i(this,(function(i){switch(i.label){case 0:return[4,e("trackPageview",t)];case 1:return(r=i.sent())?(u=r.pageviewKey,c=r.sessionId,s=r.removedKeys,Array.isArray(s)&&(0,a.removeDeadKeys)(s),"string"!=typeof u||"string"!=typeof c?[2,null]:[2,{pageviewKey:u,sessionId:c,properties:n,userInfo:o}]):[2,null]}}))}))}(g,n,f);return(0,a.setLastPageview)(y),y}}}},306:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function u(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(u){return function(c){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(a=0)),a;)try{if(n=1,r&&(i=2&u[0]?r.return:u[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,u[1])).done)return i;switch(r=0,i&&(u=[2&u[0],i.value]),u[0]){case 0:case 1:i=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!i||u[1]>i[0]&&u[1]<i[3])){a.label=u[1];break}if(6===u[0]&&a.label<i[1]){a.label=i[1],i=u;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(u);break}i[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(e){u=[6,e],r=0}finally{n=i=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.createCoreMethods=void 0;var o=n(502),a=n(270);t.createCoreMethods=function(e,t,n){void 0===n&&(n=null);var u=null==n?void 0:n.name,c=(0,o.sanitizeSourceInfo)(n,t,u);return{startRecording:function(n,r){0!==arguments.length?(0,o.isNonEmptyString)(n)?e("startRecording",{environmentId:n,options:r||{}}):t.warn("startRecording failed because environmentId was not a string.",u):t.warn("startRecording failed because environmentId was omitted.",u)},stopRecording:function(){e("stopRecording",{})},track:function(n,s,l,f,d){return r(this,void 0,void 0,(function(){var r,p,v,g,y;return i(this,(function(i){switch(i.label){case 0:return(0,o.isNonEmptyString)(n)?(r=(0,o.sanitizeProperties)(s,t,u),p=(0,o.sanitizeSourceInfo)(f,t,u)||c,v=(0,o.sanitizeTimestamp)(l,t,u),[4,(0,a.resolvePageviewKey)(d,t,u)]):(t.warn("track failed because event was not a string.",u),[2]);case 1:return g=i.sent(),y={event:n},r&&(y.properties=r),v&&(y.javascriptEpochTimestamp=v),p&&(y.sourceLibrary=p),g&&(y.pageviewKey=g),e("track",y),[2]}}))}))},identify:function(n){0!==arguments.length?(0,o.isNonEmptyString)(n)?e("identify",{identity:n}):t.warn("identify failed because identity was not a string.",u):t.warn("identify failed because identity was omitted.",u)},resetIdentity:function(){e("resetIdentity",{})},addUserProperties:function(n){var r=(0,o.sanitizeProperties)(n,t,u);r&&(0!==Object.keys(r).length?e("addUserProperties",{properties:r}):t.warn("addUserProperties was called without any valid properties."))},addEventProperties:function(n){var r=(0,o.sanitizeProperties)(n,t,u);r&&(0!==Object.keys(r).length?e("addEventProperties",{properties:r}):t.warn("addEventProperties was called without any valid properties."))},removeEventProperty:function(n){0!==arguments.length?(0,o.isNonEmptyString)(n)?e("removeEventProperty",{name:n}):t.warn("removeEventProperty failed because name was not a string.",u):t.warn("removeEventProperty failed because name was omitted.",u)},clearEventProperties:function(){e("clearEventProperties",{})},setLogLevel:function(e){t.setLogLevel(e)},getSessionId:function(){return e("sessionId",{})},fetchSessionId:function(){return e("fetchSessionId",{})},getUserId:function(){return e("userId",{})},getIdentity:function(){return e("identity",{})}}}},154:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.createHeap=void 0;var i=n(843),o=n(306);t.createHeap=function(e,t,n){return void 0===n&&(n=null),r(r({},(0,i.createAutocaptureMethods)(e,t,n)),(0,o.createCoreMethods)(e,t,n))}},270:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function u(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(u){return function(c){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(a=0)),a;)try{if(n=1,r&&(i=2&u[0]?r.return:u[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,u[1])).done)return i;switch(r=0,i&&(u=[2&u[0],i.value]),u[0]){case 0:case 1:i=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!i||u[1]>i[0]&&u[1]<i[3])){a.label=u[1];break}if(6===u[0]&&a.label<i[1]){a.label=i[1],i=u;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(u);break}i[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(e){u=[6,e],r=0}finally{n=i=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}},o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},a=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.resolvePageviewKey=t.getLastPageviewKey=t.clearLastPageview=t.setLastPageview=t.getDeadKeys=t.removeDeadKeys=t.addDeadKey=void 0;var u=n(502),c=[],s=n.g.FinalizationRegistry?new FinalizationRegistry(l):null;function l(e){c.push(e)}t.addDeadKey=l,t.removeDeadKeys=function(e){if(Array.isArray(e)){var t=new Set(e);c=c.filter((function(e){return!t.has(e)}))}},t.getDeadKeys=function(){return a([],o(c),!1)};var f=Promise.resolve(null);t.setLastPageview=function(e){f=function(e){return r(this,void 0,void 0,(function(){var t,n;return i(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,e];case 1:return t=r.sent(),n=null==t?void 0:t.pageviewKey,(0,u.isNonEmptyString)(n)?[2,n]:[3,3];case 2:return r.sent(),[3,3];case 3:return[2,null]}}))}))}(e),function(e){r(this,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,e];case 1:return(t=n.sent())&&s&&s.register(t,null==t?void 0:t.pageviewKey),[3,3];case 2:return n.sent(),[3,3];case 3:return[2]}}))}))}(e)},t.clearLastPageview=function(){f=Promise.resolve(null)},t.getLastPageviewKey=function(){return f},t.resolvePageviewKey=function(e,t,n){return r(this,void 0,void 0,(function(){var r,o;return i(this,(function(i){switch(i.label){case 0:if("none"===e)return[2,"none"];if(!function(e){return!!e&&"function"==typeof e.then}(e))return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,e];case 2:return e=i.sent(),[3,4];case 3:return r=i.sent(),e=null,t.debug("Pageview threw an error and will be ignored.",n),t.trace("Pageview error: ".concat(r),n),[3,4];case 4:if(e){if(o=e.pageviewKey,(0,u.isNonEmptyString)(o))return[2,e.pageviewKey];t.debug("Pageview did not have a valid key and will be ignored.",n)}return[4,f];case 5:return[2,i.sent()]}}))}))}},502:function(e,t,n){var r=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.sanitizeInteractionNodes=t.sanitizeInteractionType=t.sanitizePageviewProperties=t.sanitizeTimestamp=t.sanitizeSourceInfo=t.isNonEmptyString=t.sanitizeProperties=void 0;var i=n(748);function o(e,t,n){var o,a,u;if(!e)return null;if("object"!=typeof e)return t.debug("Ignoring properties because they are not an object",n),null;var c={};try{for(var s=r(Object.keys(e)),l=s.next();!l.done;l=s.next()){var f=l.value,d=e[f];(0,i.isPropertyValue)(d)?c[f]=d.toString():t.debug("Ignoring property ".concat(f," because the value ").concat((null===(u=null==d?void 0:d.toString)||void 0===u?void 0:u.call(d))||d," is not a valid property type"),n)}}catch(e){o={error:e}}finally{try{l&&!l.done&&(a=s.return)&&a.call(s)}finally{if(o)throw o.error}}return c}function a(e){return e&&"string"==typeof e}t.sanitizeProperties=o,t.isNonEmptyString=a,t.sanitizeSourceInfo=function(e,t,n){if(!e)return null;if(!a(e.name))return t.debug("Source will be ignored because name was omitted.",n),null;if(!a(e.version))return t.debug("Source will be ignored because version was omitted.",n),null;if(!a(e.platform))return t.debug("Source will be ignored because platform was omitted.",n),null;var r={name:e.name,version:e.version,platform:e.platform},i=o(e.properties,t,n);return i&&(r.properties=i),r},t.sanitizeTimestamp=function(e,t,n){return e?"function"!=typeof e.getTime?(t.debug("Timestamp will be ignored because it is not a date.",n),null):e.getTime():null},t.sanitizePageviewProperties=function(e,t,n){if(!e)return null;if("object"!=typeof e)return t.debug("Ignoring pageview properties because they are not an object",n),null;var r={},i=e.componentOrClassName,u=e.title,c=e.url,s=o(e.sourceProperties,t,n);return a(i)&&(r.componentOrClassName=i),a(u)&&(r.title=u),a(c)&&(r.url=c),s&&(r.sourceProperties=s),r},t.sanitizeInteractionType=function(e,t,n){if(!e)return t.debug("Interaction type was missing.",n),null;if(a(e))return e;var r=e.builtin;if("number"==typeof e.builtin)return{builtin:r};var i=e.custom;return a(i)?{custom:i}:(t.debug("Interaction type was of an unknown format.",n),null)},t.sanitizeInteractionNodes=function(e,t,n){if(!e||!Array.isArray(e)||0===e.length)return null;var r=e.flatMap((function(e){var r=function(e,t,n){if(!e)return null;var r=e.nodeName;if(!a(r))return t.debug("Interaction node omitted required field nodeName and will be ignored.",n),null;var i={nodeName:r};["nodeText","nodeHtmlClass","nodeId","href","accessibilityLabel","referencingPropertyName"].forEach((function(t){var n=e[t];a(n)&&(i[t]=n)}));var u=o(e.attributes,t,n);return u&&(i.attributes=u),i}(e,t,n);return r?[r]:[]}));return 0===r.length?null:r}},748:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isPropertyValue=void 0,t.isPropertyValue=function(e){return["number","boolean","string","bigint"].includes(typeof e)}},482:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isHeapSDKInvocationResult=t.isHeapSDKInvocation=t.createNoopBridge=t.LogLevel=t.createLogger=t.createHeap=void 0;var r=n(154);Object.defineProperty(t,"createHeap",{enumerable:!0,get:function(){return r.createHeap}});var i=n(123);Object.defineProperty(t,"createLogger",{enumerable:!0,get:function(){return i.createLogger}}),Object.defineProperty(t,"LogLevel",{enumerable:!0,get:function(){return i.LogLevel}});var o=n(367);Object.defineProperty(t,"createNoopBridge",{enumerable:!0,get:function(){return o.createNoopBridge}}),Object.defineProperty(t,"isHeapSDKInvocation",{enumerable:!0,get:function(){return o.isHeapSDKInvocation}}),Object.defineProperty(t,"isHeapSDKInvocationResult",{enumerable:!0,get:function(){return o.isHeapSDKInvocationResult}})},123:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createLogger=t.LogLevel=void 0;var r,i=n(502);function o(e,t,n,r){if((0,i.isNonEmptyString)(t)){var o={logLevel:n,message:t};(0,i.isNonEmptyString)(r)&&(o.source=r),e("heapLogger_log",o)}}!function(e){e.None="none",e.Error="error",e.Warn="warn",e.Info="info",e.Debug="debug",e.Trace="trace"}(r=t.LogLevel||(t.LogLevel={})),t.createLogger=function(e){return{error:function(t,n){o(e,t,r.Error,n)},warn:function(t,n){o(e,t,r.Warn,n)},info:function(t,n){o(e,t,r.Info,n)},debug:function(t,n){o(e,t,r.Debug,n)},trace:function(t,n){o(e,t,r.Trace,n)},setLogLevel:function(t){e("heapLogger_setLogLevel",{logLevel:t})},getLogLevel:function(){return e("heapLogger_logLevel",{})}}}},695:(e,t,n)=>{var r,i;Object.defineProperty(t,"__esModule",{value:!0}),t.getSwiftInvocationHandler=void 0;var o=n(482),a=n(569),u=null===(i=null===(r=window.webkit)||void 0===r?void 0:r.messageHandlers)||void 0===i?void 0:i.HeapSwiftBridge,c=function(e,t){if(!u)return Promise.resolve();var n=(0,a.createCallback)(),r=n.promise,i=n.callbackId;return u.postMessage({type:"invocation",method:e,arguments:t,callbackId:i}),r};u&&(window.__heapNativeMessage=function(e){(0,o.isHeapSDKInvocationResult)(e)&&(0,a.dispatchCallback)(e)}),t.getSwiftInvocationHandler=function(){return u?c:null}},569:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.dispatchCallback=t.createCallback=void 0;var n=0,r={};t.createCallback=function(){var e="cb:".concat(n++),t=new Promise((function(t,n){r[e]=function(e){e.error?n(e.error):t(e.data)}}));return{callbackId:e,promise:t}},t.dispatchCallback=function(e){var t;null===(t=r[e.callbackId])||void 0===t||t.call(r,e),delete r[e.callbackId]}}},u={};function c(e){var t=u[e];if(void 0!==t)return t.exports;var n=u[e]={exports:{}};return a[e].call(n.exports,n,n.exports,c),n.exports}c.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),e=c(482),t=c(482),n=c(482),r=(0,c(695).getSwiftInvocationHandler)()||(0,e.createNoopBridge)(),i=(0,n.createLogger)(r),o=(0,t.createHeap)(r,i),window.HeapLogger=i,window.Heap=o})();
"""
