// Source: https://github.com/heap/heap-webview-core/commit/76c1635da6fa1b54e81afedb3a19a511af3acf00
let heapWebviewBridgeJavascript = """
(()=>{"use strict";var e,t,r,n,i,o,a={175:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createNoopBridge=void 0;var r="\\nFailed to find a suitable bridge for Heap. All operations will be ignored.\\n\\nIf using HeapSwiftCore (Apple platforms), ensure you are calling Heap.attachWebView with the appropriate origins.\\n".trim();t.createNoopBridge=function(){var e=!1;return function(){return e||(e=!0,console.warn(r)),Promise.resolve(null)}}},367:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.createNoopBridge=void 0;var o=r(175);Object.defineProperty(t,"createNoopBridge",{enumerable:!0,get:function(){return o.createNoopBridge}}),i(r(576),t)},576:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isHeapSDKInvocation=t.isHeapSDKInvocationResult=void 0,t.isHeapSDKInvocationResult=function(e){return"result"===e.type},t.isHeapSDKInvocation=function(e){return"invocation"===e.type}},843:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function u(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,u)}c((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(u){return function(c){return function(u){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(a=0)),a;)try{if(r=1,n&&(i=2&u[0]?n.return:u[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,u[1])).done)return i;switch(n=0,i&&(u=[2&u[0],i.value]),u[0]){case 0:case 1:i=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,n=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!i||u[1]>i[0]&&u[1]<i[3])){a.label=u[1];break}if(6===u[0]&&a.label<i[1]){a.label=i[1],i=u;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(u);break}i[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(e){u=[6,e],n=0}finally{r=i=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.createAutocaptureMethods=void 0;var o=r(502),a=r(270);t.createAutocaptureMethods=function(e,t,r){void 0===r&&(r=null);var u=null==r?void 0:r.name,c=(0,o.sanitizeSourceInfo)(r,t,u);return{trackPageview:function(r,s,l,f){var p=(0,o.sanitizePageviewProperties)(r,t,u);if(!p)return t.warn("trackPageview failed because properties could not be converted to an object.",u),Promise.resolve(null);var d=(0,o.sanitizeSourceInfo)(l,t,u)||c,v=(0,o.sanitizeTimestamp)(s,t,u),g={properties:p};v&&(g.javascriptEpochTimestamp=v),d&&(g.sourceLibrary=d),g.deadKeys=(0,a.getDeadKeys)();var y=function(t,r,o){return n(this,void 0,void 0,(function(){var n,u,c,s;return i(this,(function(i){switch(i.label){case 0:return[4,e("trackPageview",t)];case 1:return(n=i.sent())?(u=n.pageviewKey,c=n.sessionId,s=n.removedKeys,Array.isArray(s)&&(0,a.removeDeadKeys)(s),"string"!=typeof u||"string"!=typeof c?[2,null]:[2,{pageviewKey:u,sessionId:c,properties:r,userInfo:o}]):[2,null]}}))}))}(g,r,f);return(0,a.setLastPageview)(y),y}}}},306:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function u(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,u)}c((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(u){return function(c){return function(u){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(a=0)),a;)try{if(r=1,n&&(i=2&u[0]?n.return:u[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,u[1])).done)return i;switch(n=0,i&&(u=[2&u[0],i.value]),u[0]){case 0:case 1:i=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,n=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!i||u[1]>i[0]&&u[1]<i[3])){a.label=u[1];break}if(6===u[0]&&a.label<i[1]){a.label=i[1],i=u;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(u);break}i[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(e){u=[6,e],n=0}finally{r=i=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.createCoreMethods=void 0;var o=r(502),a=r(270);t.createCoreMethods=function(e,t,r){void 0===r&&(r=null);var u=null==r?void 0:r.name,c=(0,o.sanitizeSourceInfo)(r,t,u);return{startRecording:function(r,n){0!==arguments.length?(0,o.isNonEmptyString)(r)?e("startRecording",{environmentId:r,options:n||{}}):t.warn("startRecording failed because environmentId was not a string.",u):t.warn("startRecording failed because environmentId was omitted.",u)},stopRecording:function(){e("stopRecording",{})},track:function(r,s,l,f,p){return n(this,void 0,void 0,(function(){var n,d,v,g,y;return i(this,(function(i){switch(i.label){case 0:return(0,o.isNonEmptyString)(r)?(n=(0,o.sanitizeProperties)(s,t,u),d=(0,o.sanitizeSourceInfo)(f,t,u)||c,v=(0,o.sanitizeTimestamp)(l,t,u),[4,(0,a.resolvePageviewKey)(p,t,u)]):(t.warn("track failed because event was not a string.",u),[2]);case 1:return g=i.sent(),y={event:r},n&&(y.properties=n),v&&(y.javascriptEpochTimestamp=v),d&&(y.sourceLibrary=d),g&&(y.pageviewKey=g),e("track",y),[2]}}))}))},identify:function(r){0!==arguments.length?(0,o.isNonEmptyString)(r)?e("identify",{identity:r}):t.warn("identify failed because identity was not a string.",u):t.warn("identify failed because identity was omitted.",u)},resetIdentity:function(){e("resetIdentity",{})},addUserProperties:function(r){var n=(0,o.sanitizeProperties)(r,t,u);n&&(0!==Object.keys(n).length?e("addUserProperties",{properties:n}):t.warn("addUserProperties was called without any valid properties."))},addEventProperties:function(r){var n=(0,o.sanitizeProperties)(r,t,u);n&&(0!==Object.keys(n).length?e("addEventProperties",{properties:n}):t.warn("addEventProperties was called without any valid properties."))},removeEventProperty:function(r){0!==arguments.length?(0,o.isNonEmptyString)(r)?e("removeEventProperty",{name:r}):t.warn("removeEventProperty failed because name was not a string.",u):t.warn("removeEventProperty failed because name was omitted.",u)},clearEventProperties:function(){e("clearEventProperties",{})},setLogLevel:function(e){t.setLogLevel(e)},getSessionId:function(){return e("sessionId",{})},fetchSessionId:function(){return e("fetchSessionId",{})},getUserId:function(){return e("userId",{})},getIdentity:function(){return e("identity",{})}}}},154:function(e,t,r){var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.createHeap=void 0;var i=r(843),o=r(306);t.createHeap=function(e,t,r){return void 0===r&&(r=null),n(n({},(0,i.createAutocaptureMethods)(e,t,r)),(0,o.createCoreMethods)(e,t,r))}},270:function(e,t,r){var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function u(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,u)}c((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(u){return function(c){return function(u){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(a=0)),a;)try{if(r=1,n&&(i=2&u[0]?n.return:u[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,u[1])).done)return i;switch(n=0,i&&(u=[2&u[0],i.value]),u[0]){case 0:case 1:i=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,n=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!i||u[1]>i[0]&&u[1]<i[3])){a.label=u[1];break}if(6===u[0]&&a.label<i[1]){a.label=i[1],i=u;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(u);break}i[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(e){u=[6,e],n=0}finally{r=i=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}},o=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a},a=this&&this.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.resolvePageviewKey=t.getLastPageviewKey=t.clearLastPageview=t.setLastPageview=t.getDeadKeys=t.removeDeadKeys=t.addDeadKey=void 0;var u=r(502),c=[],s=r.g.FinalizationRegistry?new FinalizationRegistry(l):null;function l(e){c.push(e)}t.addDeadKey=l,t.removeDeadKeys=function(e){if(Array.isArray(e)){var t=new Set(e);c=c.filter((function(e){return!t.has(e)}))}},t.getDeadKeys=function(){return a([],o(c),!1)};var f=Promise.resolve(null);t.setLastPageview=function(e){f=function(e){return n(this,void 0,void 0,(function(){var t,r;return i(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,e];case 1:return t=n.sent(),r=null==t?void 0:t.pageviewKey,(0,u.isNonEmptyString)(r)?[2,r]:[3,3];case 2:return n.sent(),[3,3];case 3:return[2,null]}}))}))}(e),function(e){n(this,void 0,void 0,(function(){var t;return i(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,e];case 1:return(t=r.sent())&&s&&s.register(t,null==t?void 0:t.pageviewKey),[3,3];case 2:return r.sent(),[3,3];case 3:return[2]}}))}))}(e)},t.clearLastPageview=function(){f=Promise.resolve(null)},t.getLastPageviewKey=function(){return f},t.resolvePageviewKey=function(e,t,r){return n(this,void 0,void 0,(function(){var n,o;return i(this,(function(i){switch(i.label){case 0:if("none"===e)return[2,"none"];if(!function(e){return!!e&&"function"==typeof e.then}(e))return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,e];case 2:return e=i.sent(),[3,4];case 3:return n=i.sent(),e=null,t.debug("Pageview threw an error and will be ignored.",r),t.trace("Pageview error: ".concat(n),r),[3,4];case 4:if(e){if(o=e.pageviewKey,(0,u.isNonEmptyString)(o))return[2,e.pageviewKey];t.debug("Pageview did not have a valid key and will be ignored.",r)}return[4,f];case 5:return[2,i.sent()]}}))}))}},502:function(e,t,r){var n=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.sanitizePageviewProperties=t.sanitizeTimestamp=t.sanitizeSourceInfo=t.isNonEmptyString=t.sanitizeProperties=void 0;var i=r(748);function o(e,t,r){var o,a,u;if(!e)return null;if("object"!=typeof e)return t.debug("Ignoring properties because they are not an object",r),null;var c={};try{for(var s=n(Object.keys(e)),l=s.next();!l.done;l=s.next()){var f=l.value,p=e[f];(0,i.isPropertyValue)(p)?c[f]=p.toString():t.debug("Ignoring property ".concat(f," because the value ").concat((null===(u=null==p?void 0:p.toString)||void 0===u?void 0:u.call(p))||p," is not a valid property type"),r)}}catch(e){o={error:e}}finally{try{l&&!l.done&&(a=s.return)&&a.call(s)}finally{if(o)throw o.error}}return c}function a(e){return e&&"string"==typeof e}t.sanitizeProperties=o,t.isNonEmptyString=a,t.sanitizeSourceInfo=function(e,t,r){if(!e)return null;if(!a(e.name))return t.debug("Source will be ignored because name was omitted.",r),null;if(!a(e.version))return t.debug("Source will be ignored because version was omitted.",r),null;if(!a(e.platform))return t.debug("Source will be ignored because platform was omitted.",r),null;var n={name:e.name,version:e.version,platform:e.platform},i=o(e.properties,t,r);return i&&(n.properties=i),n},t.sanitizeTimestamp=function(e,t,r){return e?"function"!=typeof e.getTime?(t.debug("Timestamp will be ignored because it is not a date.",r),null):e.getTime():null},t.sanitizePageviewProperties=function(e,t,r){if(!e)return null;if("object"!=typeof e)return t.debug("Ignoring pageview properties because they are not an object",r),null;var n={},i=e.componentOrClassName,u=e.title,c=e.url,s=o(e.sourceProperties,t,r);return a(i)&&(n.componentOrClassName=i),a(u)&&(n.title=u),a(c)&&(n.url=c),s&&(n.sourceProperties=s),n}},748:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isPropertyValue=void 0,t.isPropertyValue=function(e){return["number","boolean","string","bigint"].includes(typeof e)}},482:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isHeapSDKInvocationResult=t.isHeapSDKInvocation=t.createNoopBridge=t.createLogger=t.createHeap=void 0;var n=r(154);Object.defineProperty(t,"createHeap",{enumerable:!0,get:function(){return n.createHeap}});var i=r(123);Object.defineProperty(t,"createLogger",{enumerable:!0,get:function(){return i.createLogger}});var o=r(367);Object.defineProperty(t,"createNoopBridge",{enumerable:!0,get:function(){return o.createNoopBridge}}),Object.defineProperty(t,"isHeapSDKInvocation",{enumerable:!0,get:function(){return o.isHeapSDKInvocation}}),Object.defineProperty(t,"isHeapSDKInvocationResult",{enumerable:!0,get:function(){return o.isHeapSDKInvocationResult}})},123:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createLogger=void 0;var n=r(502);function i(e,t,r,i){if((0,n.isNonEmptyString)(t)){var o={logLevel:r,message:t};(0,n.isNonEmptyString)(i)&&(o.source=i),e("heapLogger_log",o)}}t.createLogger=function(e){return{error:function(t,r){i(e,t,"error",r)},warn:function(t,r){i(e,t,"warn",r)},info:function(t,r){i(e,t,"info",r)},debug:function(t,r){i(e,t,"debug",r)},trace:function(t,r){i(e,t,"trace",r)},setLogLevel:function(t){e("heapLogger_setLogLevel",{logLevel:t})},getLogLevel:function(){return e("heapLogger_logLevel",{})}}}},695:(e,t,r)=>{var n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.getSwiftInvocationHandler=void 0;var o=r(482),a=r(569),u=null===(i=null===(n=window.webkit)||void 0===n?void 0:n.messageHandlers)||void 0===i?void 0:i.HeapSwiftBridge,c=function(e,t){if(!u)return Promise.resolve();var r=(0,a.createCallback)(),n=r.promise,i=r.callbackId;return u.postMessage({type:"invocation",method:e,arguments:t,callbackId:i}),n};u&&(window.__heapNativeMessage=function(e){(0,o.isHeapSDKInvocationResult)(e)&&(0,a.dispatchCallback)(e)}),t.getSwiftInvocationHandler=function(){return u?c:null}},569:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.dispatchCallback=t.createCallback=void 0;var r=0,n={};t.createCallback=function(){var e="cb:".concat(r++),t=new Promise((function(t,r){n[e]=function(e){e.error?r(e.error):t(e.data)}}));return{callbackId:e,promise:t}},t.dispatchCallback=function(e){var t;null===(t=n[e.callbackId])||void 0===t||t.call(n,e),delete n[e.callbackId]}}},u={};function c(e){var t=u[e];if(void 0!==t)return t.exports;var r=u[e]={exports:{}};return a[e].call(r.exports,r,r.exports,c),r.exports}c.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),e=c(482),t=c(482),r=c(482),n=(0,c(695).getSwiftInvocationHandler)()||(0,e.createNoopBridge)(),i=(0,r.createLogger)(n),o=(0,t.createHeap)(n,i),window.HeapLogger=i,window.Heap=o})();
"""
